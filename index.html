<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Atom POS System</title>

<style>
body { font-family: Arial; background:#111; color:#fff; margin:0; }
header { background:#1a1a1a; padding:1rem; }
.nav-btn { margin-right:10px; padding:8px 12px; cursor:pointer; }
.nav-btn.active { background:#dc2626; color:#fff; }
.container { padding:20px; }
.product-card { background:#1a1a1a; padding:15px; margin:10px; border-radius:8px; width:220px; display:inline-block; vertical-align:top; }
.product-card img { width:100%; height:150px; object-fit:cover; }
button { padding:6px 10px; margin:3px; cursor:pointer; }
.cart-item { background:#1a1a1a; padding:10px; margin:5px 0; }
.order-card { background:#1a1a1a; padding:10px; margin:10px 0; }
input { padding:6px; margin:5px; }
.low-stock { color:red; }
</style>
</head>

<body>

<header>
    <button class="nav-btn active" onclick="showSection('products')">Products</button>
    <button class="nav-btn" onclick="showSection('cart')">Cart (<span id="cartBadge">0</span>)</button>
    <button class="nav-btn" onclick="showSection('orders')">Sales</button>
    <button class="nav-btn" onclick="showSection('inventory')">Inventory</button>
    <button onclick="location.reload()">Reset</button>
</header>

<div class="container">

<!-- PRODUCTS -->
<section id="productsSection">
<h2>Products</h2>

<input type="text" id="searchInput" placeholder="Search products...">
<button onclick="sortProducts('low')">Low → High</button>
<button onclick="sortProducts('high')">High → Low</button>
<button onclick="clearSearch()">Clear</button>

<div id="productsGrid"></div>
</section>

<!-- CART -->
<section id="cartSection" style="display:none;">
<h2>Current Sale</h2>
<div id="cartItems"></div>
<h3>Total: ₱<span id="total">0</span></h3>
<button onclick="completeSale()">Complete Sale</button>
</section>

<!-- SALES -->
<section id="ordersSection" style="display:none;">
<h2>Sales History</h2>
<div id="ordersList"></div>
</section>

<!-- INVENTORY -->
<section id="inventorySection" style="display:none;">
<h2>Inventory</h2>

<input type="text" id="inventorySearch" placeholder="Search inventory...">
<button onclick="quickRestock()">Quick Restock Low Stock</button>
<button onclick="showReports()">View Sales Report</button>

<div id="inventoryList"></div>
</section>

</div>

<script>
const products = [
{ id:1, name:"Night Ripper II", price:6500, description:"High-power LED", stock:10 },
{ id:2, name:"Mini Version III", price:3000, description:"Compact", stock:15 },
{ id:3, name:"Night Ripper Plus", price:5500, description:"Enhanced", stock:8 },
{ id:4, name:"Mini Plus", price:4000, description:"Portable", stock:12 },
{ id:5, name:"Quad Beam", price:7500, description:"Multi-beam", stock:5 },
{ id:6, name:"Mini Pod", price:3000, description:"Efficient", stock:20 }
];

let cart = {};
let orders = [];

/* SECTION SWITCH */
function showSection(section){
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.getElementById(section+"Section").style.display="block";
document.querySelectorAll(".nav-btn").forEach(b=>b.classList.remove("active"));
}

/* DISPLAY PRODUCTS */
function displayProducts(list=products){
const grid=document.getElementById("productsGrid");
grid.innerHTML=list.map(p=>`
<div class="product-card">
<h3>${p.name}</h3>
<p>${p.description}</p>
<p>₱${p.price}</p>
<p class="${p.stock<=5?'low-stock':''}">Stock: ${p.stock}</p>
<button onclick="addToCart(${p.id})">Add</button>
</div>`).join("");
}
displayProducts();

/* SEARCH */
document.getElementById("searchInput").addEventListener("input",()=>{
const q=searchInput.value.toLowerCase();
displayProducts(products.filter(p=>
p.name.toLowerCase().includes(q)||
p.description.toLowerCase().includes(q)
));
});
function clearSearch(){ searchInput.value=""; displayProducts(); }

/* SORT */
function sortProducts(type){
let sorted=[...products];
sorted.sort((a,b)=>type==="low"?a.price-b.price:b.price-a.price);
displayProducts(sorted);
}

/* CART */
function addToCart(id){
const p=products.find(x=>x.id===id);
if(p.stock<=0) return alert("Out of stock!");
if(cart[id]&&cart[id].qty>=p.stock) return alert("Cannot exceed stock!");

cart[id]?cart[id].qty++:cart[id]={...p,qty:1};
updateCart();
}

function updateCart(){
const items=Object.values(cart);
const div=document.getElementById("cartItems");
if(items.length===0){ div.innerHTML="Cart empty"; total.textContent=0; return; }

div.innerHTML=items.map(i=>`
<div class="cart-item">
${i.name} x ${i.qty} = ₱${i.price*i.qty}
<button onclick="changeQty(${i.id},-1)">-</button>
<button onclick="changeQty(${i.id},1)">+</button>
<button onclick="removeItem(${i.id})">Remove</button>
</div>`).join("");

const sum=items.reduce((s,i)=>s+i.price*i.qty,0);
total.textContent=sum;
cartBadge.textContent=items.reduce((s,i)=>s+i.qty,0);
}

function changeQty(id,c){
const p=products.find(x=>x.id===id);
if(!cart[id]) return;
let newQty=cart[id].qty+c;
if(newQty>p.stock) return alert("Cannot exceed stock!");
newQty<=0?delete cart[id]:cart[id].qty=newQty;
updateCart();
}
function removeItem(id){ delete cart[id]; updateCart(); }

/* COMPLETE SALE */
function completeSale(){
const items=Object.values(cart);
if(!items.length) return alert("No items!");
const totalSale=items.reduce((s,i)=>s+i.price*i.qty,0);

orders.push({
id:"REC-"+Date.now(),
date:new Date().toLocaleString(),
items:JSON.parse(JSON.stringify(items)),
total:totalSale
});

items.forEach(i=>{
let p=products.find(x=>x.id===i.id);
p.stock-=i.qty;
});

cart={};
updateCart();
displayProducts();
alert("Sale completed!");
showSection("orders");
displayOrders();
}

/* ORDERS */
function displayOrders(){
ordersList.innerHTML=orders.map(o=>`
<div class="order-card">
<h4>${o.id}</h4>
<p>${o.date}</p>
${o.items.map(i=>`<p>${i.name} x ${i.qty}</p>`).join("")}
<strong>Total ₱${o.total}</strong>
<button onclick="printReceipt('${o.id}')">Print</button>
</div>`).join("");
}

function printReceipt(id){
const r=orders.find(x=>x.id===id);
const w=window.open("");
w.document.write(`<h2>ATOM POS</h2>
<p>${r.id}</p>
${r.items.map(i=>`<p>${i.name} x ${i.qty}</p>`).join("")}
<h3>Total ₱${r.total}</h3>`);
w.print();
}

/* INVENTORY */
function displayInventory(list=products){
inventoryList.innerHTML=list.map(p=>
`<p>${p.name} - Stock: ${p.stock}</p>`
).join("");
}
displayInventory();

inventorySearch.addEventListener("input",()=>{
const q=inventorySearch.value.toLowerCase();
displayInventory(products.filter(p=>p.name.toLowerCase().includes(q)));
});

/* RESTOCK */
function quickRestock(){
products.forEach(p=>{ if(p.stock<=5) p.stock+=10; });
displayInventory();
displayProducts();
alert("Low stock restocked!");
}

/* REPORT */
function showReports(){
let revenue=orders.reduce((s,o)=>s+o.total,0);
let items=orders.reduce((s,o)=>s+o.items.reduce((x,i)=>x+i.qty,0),0);
alert(`Orders: ${orders.length}\nItems Sold: ${items}\nRevenue: ₱${revenue}`);
}
</script>

</body>
</html>
